<!DOCTYPE html>
<html lang="en">

<style>
/*county map css*/
	body, div, dl, dt, dd, ul, ol, li, h1, h2, h3, h4, h5, h6, pre, form, fieldset, input, p, blockquote, th, td, legend {
		margin: 0;
		padding: 0;
	}
	table {
		border-collapse: collapse;
		border-spacing: 0;
	}
	fieldset, img {
		border: 0;
	}
	caption, th {
		text-align: left;
	}
	.legend .legendheader {
		font-family: Helvetica, sans-serif;
		font-weight: bold;
		font-size: 29px;
	}
	.legend .ticklabel {
		font-size: 29px;
		font-family: Helvetica, sans-serif;
	}
	.left {
		width: 20px;
		float: left;
		text-align: left;
	}
	.right {
		width: 25px;
		float: right;
		text-align: right;
	}
	.exspace {
		line-height: 2.0;
	}
	.domhead {
		font-weight: bold;
		font-size: 11px;
		font-style: italic;
	}
	div.tooltip {
		position: absolute;
		text-align: left;
		width: 180px;
		padding: 10px;
		font-size: 10px;
		font-family: Helvetica, sans-serif;
		background: #ffffff;
		pointer-events: none;
		opacity: 0;
		border: 1px solid #ccc;
	}
	div.tooltip h3 {
		font-size: 13px;
		margin: 0 0 10px 0;
		border-bottom: 2px solid #000;
		padding-bottom: 6px;
		line-height: 1.2em;
	}
	div.tooltip .vals {
		vertical-align: bottom;
	}
	div.tooltip .state {
		text-transform: uppercase;
		margin-bottom: 4px;
	}
	div.tooltip .hwbi {
		font-size: 11px;
		font-weight: bold;
	}
	div.tooltip .moe {
		color: #aaa;
		font-size: 11px;
	}
	div.tooltip .cn {
		font-size: 11px;
	}
	div.tooltip .cn_moe {
		color: #aaa;
		font-size: 11px;
	}
	div.tooltip .cf {
		font-size: 11px;
	}
	div.tooltip .cf_moe {
		color: #aaa;
		font-size: 11px;
	}
	div.tooltip .ed {
		font-size: 11px;
	}
	div.tooltip .ed_moe {
		color: #aaa;
		font-size: 11px;
	}
	div.tooltip .he {
		font-size: 11px;
	}
	div.tooltip .he_moe {
		color: #aaa;
		font-size: 11px;
	}
	div.tooltip .lt {
		font-size: 11px;
	}
	div.tooltip .lt_moe {
		color: #aaa;
		font-size: 11px;
	}
	div.tooltip .ls {
		font-size: 11px;
	}
	div.tooltip .ls_moe {
		color: #aaa;
		font-size: 11px;
	}
	div.tooltip .ss {
		font-size: 11px;
	}
	div.tooltip .ss_moe {
		color: #aaa;
		font-size: 11px;
	}
	div.tooltip .sc {
		font-size: 11px;
	}
	div.tooltip .sc_moe {
		color: #aaa;
		font-size: 11px;
	}
	#countymap {
		margin-top: 5px;
	}
	.overlay {
		fill: none;
		pointer-events: all;
	}
	.button {
		fill: #000;
	}
	.counties {
		fill: none;
		stroke: #fff;
		stroke-width: 0.5px;
	    stroke-linejoin: round;
	}
	.states {
		fill: none;
		stroke: #fff;
		stroke-width: 1.5px;
		stroke-linejoin: round;
	}
	.counties path.selected {
		stroke: #000;
		stroke-width: 0.5px;
		fill: #000;
	}
	.counties path.same {
		fill: #cccccc;
	}
	.counties path.greater {
		fill: red;
	}
	.counties path.lesser {
		fill: green;
	}
	.svg-container {
	    display: inline-block;
	    position: relative;
	    width: 100%;
	    padding-bottom: 100%; /* aspect ratio */
	    vertical-align: top;
	{#    overflow: hidden;#}
	}
	.svg-content-responsive {
	    display: inline-block;
	    position: absolute;
	    top: 10px;
	    left: 0;
	}
{#/*dashboard css*/#}
    .tab-content{
        display: none;
        background: #ffffff;
        padding: 1px;
    }
    .tab-content.current{
        display: inherit;
    }
    .axis text {
      display: none;
    }
    .axis .halo {
      stroke: #aaa;
      stroke-width: 5px;
    }
    .slider .handle text {
      fill: black;
      text-align: center;
      font-size: 13px;
    }
    #cirSlide {
        font-size: 13px;
        padding: 2px 10px 2px 2px;
    }
    /* format d3.js tooltip for pie chart mouse-over */
    .d3-tip {
      line-height: 1;
      padding: 12px;
      background: rgba(0, 0, 0, 0.8);
      color: #fff;
      border-radius: 2px;
      pointer-events: none;
    }
    /* set county & state input fields */
    #statecounty {
        color: #74646e;
        width: 150px;
        padding: 2px 10px 2px 2px;
        font-size: 14px;
    }
    /* size button font */
    #updateServices {
        font-size: 12px;
    }
    p {
        font-size: 14px;
    }
    .radio-toolbar label {
        color: #74646e;
        display:inline-block;
        padding:4px 11px;
        font-family:Arial;
        font-size:13px;
    }
    #riv {
        font-family:Arial;
        font-size:11px;
        margin: 0;
		padding: 0;
    }
</style>

<head>

<script src="/static_qed/hwbi/js/d3.v3.min.js"></script>
<script src="/static_qed/hwbi/js/d3.tip.v0.6.3.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script type="text/javascript" src="/static_qed/js/jquery.blockUI.js"></script>
{#<script src="/static_qed/js/scripts_input.js"></script>#}

<script src="http://d3js.org/queue.v1.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>


    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="HWBI Dashboard">
    <meta name="author" content="U.S. EPA">
	<meta name="keywords" content="environment,hwbi,ecosystem,services,EPA">
    <title>HWBI</title>
    <!-- Bootstrap Core CSS -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-7s5uDGW3AHqw6xtJmNNtr+OBRJUlgkNJEo78P4b0yRw= sha512-nNo+yCHEyn0smMxSswnf/OnX6/KwJuZTlNZBjauKhTK0c+zT+q5JOCx0UFhXQ6rJR9jg6Es8gPuD2uZcYDLqSw==" crossorigin="anonymous">
    <!-- Custom CSS -->
	<link rel="stylesheet" type="text/css" href="/static_qed/hwbi/css/etrends.css" />
	<link rel="shortcut icon" href="https://wcms.epa.gov/sites/all/themes/epa/favicon.ico" type="image/x-icon">
	<link rel="icon" href="https://wcms.epa.gov/sites/all/themes/epa/favicon.ico" type="image/x-icon">

	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
   <script type="text/javascript">
	setTimeout(function(){var a=document.createElement("script");
	var b=document.getElementsByTagName("script")[0];
	a.src=document.location.protocol+"//script.crazyegg.com/pages/scripts/0005/9240.js?"+Math.floor(new Date().getTime()/3600000);
	a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
	</script>
</head>

<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">
	<!-- Google Tag Manager -->
	<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-L8ZB"
	height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({"gtm.start":
	new Date().getTime(),event:"gtm.js"});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!="dataLayer"?"&l="+l:"";j.async=true;j.src=
	"//www.googletagmanager.com/gtm.js?id="+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,"script","dataLayer","GTM-L8ZB");</script>
	<!-- End Google Tag Manager -->
	<div class="se-pre-con">
		<div class="report-loading-container">
			<div class="report-loading-position">
				<img class="epa_seal" src="/static_qed/hwbi/images/epa_seal_trim_300.svg" alt="United States Environmental Protection Agency" />
				<div class="report-loading-text">HWBI tools are loading<br>
					<i class="spinner icon icon-spinner" aria-hidden="true"></i>
				</div>
			</div>
		</div>
		<span class="sr-only">Loading...</span>
	</div>

	<!-- Navigation -->
	<nav class="navbar navbar-custom navbar-fixed-top" role="navigation" id="report-nav">
		<div class="container-fluid">
		<a href="#welcome" class="skip">Skip to content</a>
			<div class="col-md-12 col-lg-10 col-lg-offset-1">
				<div class="navbar-header" >
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-main-collapse" title="Main navigation button">
						<i class="icon icon-bars icon-lg" aria-hidden="true"></i>
					</button>
					<span class="navbar-brand">
						<a  href="https://epa.gov" title="Open epa.gov in another browser window" target="_blank">
							<i class="icon icon-epaflower icon-lg" aria-hidden="true"></i>
						</a>
						<a class="page-scroll" href="#page-top" title="Jump to top of report">
							<span class="light">Home</span>
						</a>
					</span>
					<!-- Single share button -->
					<div id="singleShare" class="mobile-social-share btn-group">
					  <button type="button" class="btn btn-mobile-share navbar-btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" title="Share this report!">
					  <i class="icon icon-share-alt" aria-hidden="true"></i> <span class="caret"></span>
					  </button>
					  <ul class="dropdown-menu">
						<li>
							<a data-toggle="tooltip" data-original-title="Share on Twitter" data-placement="right" class="btn btn-twitter" href="https://twitter.com/home?status=Check%20out%20the%20EPA's%20annual%20air%20trends%20report!%20%0Ahttps%3A//gispub.epa.gov/air/trendsreport/2016/%20%23ournationsair" target="_blank">
								<i class="icon icon-twitter icon-lg" aria-hidden="true"></i>
							</a>
						</li>
						<li>
							<a data-toggle="tooltip" data-original-title="Share on Facebook" data-placement="right" class="btn btn-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A//gispub.epa.gov/air/trendsreport/2016/" target="_blank">
								<i class="icon icon-facebook icon-lg" aria-hidden="true"></i>
							</a>
						</li>
						<li>
							<a data-toggle="tooltip" data-original-title="Share on Reddit" data-placement="right" class="btn btn-reddit" href="http://reddit.com/submit?url=https%3A%2F%2Fgispub.epa.gov%2Fair%2Ftrendsreport%2F2016&title=Our%20Nation's%20Air" target="_blank">
								<i class="icon icon-reddit icon-lg" aria-hidden="true"></i>
							</a>
						</li>
						<li>
							<a data-toggle="tooltip" data-original-title="Share on LinkedIn" data-placement="right" class="btn btn-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A//gispub.epa.gov/air/trendsreport/2016&title=Our%20Nation's%20Air&summary=Check%20out%20the%20Environmental%20Protection%20Agency's%20annual%20air%20trends%20report!%20https%3A//gispub.epa.gov/air/trendsreport/2016&source=U.S.%20EPA" target="_blank">
								<i class="icon icon-linkedin icon-lg" aria-hidden="true"></i>
							</a>
						</li>
						<li>
							<a data-toggle="tooltip" data-original-title="Share on Pinterest" data-placement="right" class="btn btn-pinterest" href="https://pinterest.com/pin/create/button/?url=U.S.%20EPA&media=https%3A//gispub.epa.gov/air/trendsreport/2016/img/Criteria_Air_Pollutant_Trends.png&description=Check%20out%20the%20Environmental%20Protection%20Agency's%20annual%20air%20trends%20report!%20https%3A//gispub.epa.gov/air/trendsreport/2016" target="_blank">
								<i class="icon icon-pinterest icon-lg" aria-hidden="true"></i>
							</a>
						</li>
						<li>
							<a data-toggle="tooltip" data-original-title="Share on Email" data-placement="right" class="btn btn-mail" href="mailto:?subject=Our%20Nation's%20Air&body=Check%20out%20the%20Environmental%20Protection%20Agency's%20annual%20air%20trends%20report!%0Ahttps%3A//gispub.epa.gov/air/trendsreport/2016">
								<i class="icon icon-envelope icon-lg" aria-hidden="true"></i>
							</a>
						</li>
					  </ul>
					</div>
				</div>

				<!-- Collect the nav links, forms, and other content for toggling -->
				<div class="collapse navbar-collapse navbar-right navbar-main-collapse">
					<ul class="nav navbar-nav">
						<!-- Hidden li included to remove active class from about link when scrolled up past about section -->
						<li data-menuanchor="sec1" class="hidden">
							<a href="#page-top"></a>
						</li>
						<li>
							<!--<a class="page-scroll" href="#about">Welcome</a>-->
						</li>
						<li data-menuanchor="sec3">
							<a class="page-scroll" href="#introduction" title="Jump to HWBI Introduction section">Intro</a>
						</li>
						<li data-menuanchor="sec8">
							<a class="page-scroll" href="#map" title="Jump to County Map section">Map</a>
						</li>
						<li data-menuanchor="sec10">
							<a class="page-scroll" href="#dashboard" title="Jump to Dashboard section">Dashboard</a>
						</li>
						<li data-menuanchor="sec15">
							<a class="page-scroll" href="#algorithms" title="Jump to Algorithms section">Algorithms</a>
						</li>
						<li data-menuanchor="sec17">
							<a class="page-scroll" href="#resources" title="Jump to Resources section">Resources</a>
						</li>
					</ul>
				</div>
			</div>
			<!-- /.navbar-collapse -->
		</div>
		<!-- /.container -->
	</nav>



	<!-- HWBI Header -->
    <div id="fullpage">

    {#NOTE SOMETHING IN THIS COMMENTED OUT SECTION IS AFFECTING THE COUNTY MAP POP-UP FROM DISPLAYING AT ALL. IN ADDITION, THE ETRENDS CSS IS MAKING POPUP WORDS GREY. #}
		<section class="secFP">
			<div class="reportIntro">
				<div class="reportIntro-body">
					<div class="container-fluid">
						<div class="row">
							<div class="col-md-10 col-md-offset-1">
								<br><h1 class="brand-heading wow fadeInUpBig" data-wow-duration="1.5s">HWBI</h1>
								<p class="subtext reportIntro-text wow fadeIn" data-wow-delay="1.5s" data-wow-duration="1s">US EPA HUMAN WELL-BEING INDEX<br>
								</p>
								<div class="hi-icon-wrap hi-icon-effect-8 wow fadeIn" data-wow-delay="2s" data-wow-duration="1s">
									<a href="#welcome" class="page-scroll hi-icon icon icon-angle-double-down" aria-hidden="true" title="Scroll to Welcome message"></a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>

		<!-- Welcome Section -->
		<section class="secFP" id="welcome">
			<div class="container-fluid text-center">
				<div class="row paddingfromtop">
					<div class="col-md-10 col-md-offset-1 col-lg-8 col-lg-offset-2">
						<p class="p2 subtext wow fadeIn" data-wow-duration="2s" data-wow-delay=".15s">Welcome!</p>
						<p class="wow fadeIn hover_img" data-wow-duration="2s" data-wow-delay=".65s">The mission of the U.S. Environmental Protection Agency (EPA) is to protect human health and the environment. This set of tools presents the spatial trends in the nation's human well-being, and summarizes the detailed information found in the 2012 <a href="https://cfpub.epa.gov/si/si_public_record_report.cfm?dirEntryId=242106" target="_blank" title="Click to view HWBI report">Report<span><img data-src="/static_qed/hwbi/images/epa_seal_medium_trim_80x80.png" alt="HWBI report image" /></span></a>.</p>
						<p class="em1_2 wow fadeIn hover_img" data-wow-duration="2s" data-wow-delay=".65s">Please scroll down to view the annual report, use the top menu to jump to a topic. If encountering any issues viewing content, update or try opening the website in another browser.</p>
						<img class="wow fadeIn" data-wow-duration="2s" data-wow-delay=".65s" data-src="/static_qed/hwbi/images/epa_seal_medium_trim_80x80.png" alt="United States Environmental Protection Agency">
					</div>
				</div>
			</div><br>
		</section>

		<!-- Introduction Section -->
		<section class="secFP" id="introduction">
			<div class="container">
				<div class="row">
					<div class="col-md-10 col-md-offset-1 wow fadeIn" data-wow-duration="2s" data-wow-delay=".2s">
						<h2 class="story-text">The HWBI was developed using over one hundred nationally-available data layers to assess economic, social, and ecosystem services across the U.S. at regional, state, and county scales for years 2000-2010.</h2>
					</div>
				</div>
			</div>
		</section>
    {#NOTE END OF BAD D3 MAP LABEL SECTION #}



		<!-- County Map Section -->
		<section class="secFP" id="map">
			<div class="container-fluid">
				<div class="row paddingfromtop">
					<div class="col-md-4 col-lg-4 col-lg-offset-1 wow fadeIn" data-wow-duration="2s" data-wow-delay=".2s">
						<h3>HWBI Map</h3>
						<p class="em1_2">Select a county to see how others compare.</p>
						<p class="em_95">Select a county to see how others compare.</p>
					</div>
					<div class="col-md-8 col-lg-6 wow fadeInRight" data-wow-duration="2s" data-wow-delay=".4s">
						<div class="embed-responsive embed-responsive-4by3">
							<object>

								<div id="map-wrapper">
								        <div id="tooltip" class="tooltip" style="opacity: 0; left: 752px; top: 70px;">

								            <div class="state">Maine</div>

								            <h3 class="name">Penobscot County</h3>

								            <div class="hwbi">22.0<span class="moe">0.6</span></div>

								            <hr>

								            <div> <text class="domhead exspace">Domain sub-indexes</text></div>

								            <div class="cn">22.0<span class="cn_moe">0.6</span></div>
								            <div class="cf">22.0<span class="cf_moe">0.6</span></div>
								            <div class="ed">22.0<span class="ed_moe">0.6</span></div>
								            <div class="he">22.0<span class="he_moe">0.6</span></div>
								            <div class="lt">22.0<span class="lt_moe">0.6</span></div>
								            <div class="ls">22.0<span class="ls_moe">0.6</span></div>
								            <div class="ss">22.0<span class="ss_moe">0.6</span></div>
								            <div class="sc">22.0<span class="sc_moe">0.6</span></div>
								            <div class="_label exspace">(0 to 100 scale)</div>
								        </div>

								</div>


								<!-- County Map javascript -->
								<script>

									var width = window.innerWidth,
									    height = window.innerHeight,
									    center = [width / 2, height / 2],
									    defaultFill = "#e0e0e0";

									console.log(width);

									var formatHwbi = d3.format(".1f");
									var qcolors = ["#8c510a", "#D9A55F", "#e0e0e0", "#80cdc1", "#35978f"];
									var qlabels = ["Much More", "More", "About same", "Less", "Much Less"];


									var currFIPS,
									    currCountyMin,
									    currCountyMax,
									    hwbiByFIPS = d3.map();


									var projection = d3.geo.albersUsa()
{#									    .scale(2250)#}
                                        .scale(1280)
									    .translate([width / 2, height / 2]);

									var path = d3.geo.path()
									    .projection(projection);

									var zoom = d3.behavior.zoom()
									    .scaleExtent([1, 8])
									    .on("zoom", move);


									var svg = d3.select("body #map-wrapper")
									   .append("svg")
									       .attr("preserveAspectRatio", "xMinYMin meet")
									       .attr("viewBox", "0 0 1000 700") //aspect ratio. similar to scale

									   .append("svg")
									   .classed("svg-container", true) //container class to make it responsive
									   //responsive SVG needs these 2 attributes and no width and height attr
									   .attr("preserveAspectRatio", "xMinYMin meet")
									   .attr("viewBox", "0 0 1950 350") //aspect ratio. similar to scale
									   //class to make it responsive
									   .classed("svg-content-responsive", true)
									    .attr("id", "countymap")
									  .append("g")
									    .call(zoom);
									svg.on("wheel.zoom", null);
									svg.on("mousewheel.zoom", null);

									svg.append("rect")
									    .attr("class", "overlay")
									    .attr("width", width)
									    .attr("height", height);

									svg.append("svg:image")
									    .attr("xlink:href", "/static_qed/hwbi/images/progress_anim.gif")
									    .attr("id", "progress-image")
									    .attr("width", 43)
									    .attr("height", 11)
									    .attr("x", width / 2)
									    .attr("y", height / 2);

									var g = svg.append("g");

									var tooltip = d3.select("#tooltip")
									  .style("opacity", 0);


									// Legend
									var legend = svg.append("g")
									    .attr("class", "legend");
									legend.append("rect")
									    .attr("x", width - 200)
									    .attr("y", height - 340)
									    .attr("width", 200)
									    .attr("height", 275)
									    .attr("fill", "#ffffff")
									    .attr("opacity", 0.9);
									legend.append("text")
									    .attr("class", "legendheader")
									    .attr("x", width - 190)
									    .attr("y", height - 310)
									    .text("Human");
									legend.append("text")
									    .attr("class", "legendheader")
									    .attr("x", width - 190)
									    .attr("y", height - 280)
									    .text("Well-Being");
									legend.append("text")
									    .attr("class", "legendheader")
									    .attr("x", width - 190)
									    .attr("y", height - 250)
									    .text("Index");

									legend.selectAll("rect.legend")
									    .data([0, 1, 2, 3, 4])
									  .enter().append("rect")
									    .attr("x", width - 190)
									    .attr("y", function(d, i) { return height - i * 30 - 115; })
									    .attr("width", 10)
									    .attr("height", 30)
									    .style("fill", function(d, i) { return qcolors[i]; })
									legend.selectAll(".ticklabel")
									    .data([0, 1, 2, 3, 4])
									  .enter().append("text")
									    .attr("class", "ticklabel")
									    .attr("x", width - 175)
									    .attr("y", function(d, i) { return height - i * 30 - 90; })
									    .text(function(d, i) { return qlabels[i]; });


									queue()
									    .defer(d3.json, "/static_qed/hwbi/json/us.json")
									    .defer(d3.csv, "/static_qed/hwbi/data/hwbi_decade.csv", typeAndSet)
									    .await(ready);

									var clickedOnce = false;
									var timer;

									function ready(error, us, commute) {

									    g.append("g")
									        .attr("class", "counties")
									        .selectAll("path")
									          .data(topojson.feature(us, us.objects.counties).features)
									        .enter().append("path")
									          .attr("d", path)
									          .attr("fill", "#e0e0e0")
									          .on("click", function(d) {
									              if (clickedOnce) {
									                clickedOnce = false;
									                clearTimeout(timer);
									              } else {
									                timer = setTimeout(function() {
									                    currFIPS = d.id;
									                    updateClasses();
									                    clickedOnce = false;
									                }, 190);
									                clickedOnce = true;
									              }

									          })
									          .on("mouseover", function(d) {

									               d3.select(this).classed("selected", true);
									               tooltip.transition().duration(150)
									                    .style("opacity", 1);

									               // Position tooltip
									               if (d3.event.pageX > (width - 220)) {
									                   tooltip.style("left", (d3.event.pageX - 230) + "px");
									               } else {
									                   tooltip.style("left", (d3.event.pageX + 20) + "px")
									                       .style("top", (d3.event.pageY - 80) + "px");
									               }

									               if (d3.event.pageY > (height - 170)) {
									                    tooltip.style("top", (d3.event.pageY - 160) + "px");
									               } else {
									                    tooltip.style("top", (d3.event.pageY + 50) + "px");
									               }

									               // Populate tooltip
									               var county = hwbiByFIPS.get(d.id);
									               tooltip.select(".state").text(county.state);
									               tooltip.select(".name").text(county.name);
												   tooltip.select(".hwbi").html('<text>Well-Being:  </text>' + '<span class="moe right">&plusmn;' + formatHwbi(county.moe) + "</span>" + '<span class="hwbi right">' + formatHwbi(county.hwbi) + '</span>');
												   tooltip.select(".cn").html('<text>Connection to Nature:  </text>' + '<span class="cn_moe right">&plusmn;' + formatHwbi(county.cn_moe) + "</span>" + '<span class="cn right">' + formatHwbi(county.cn) + '</span>');
												   tooltip.select(".cf").html('<text>Cultural Fulfillment:  </text>' + '<span class="cf_moe right">&plusmn;' + formatHwbi(county.cf_moe) + "</span>" + '<span class="cf right">' + formatHwbi(county.cf) + '</span>');
												   tooltip.select(".ed").html('<text>Education:  </text>' + '<span class="ed_moe right">&plusmn;' + formatHwbi(county.ed_moe) + "</span>" + '<span class="ed right">' + formatHwbi(county.ed) + '</span>');
												   tooltip.select(".he").html('<text>Health:  </text>' + '<span class="he_moe right">&plusmn;' + formatHwbi(county.he_moe) + "</span>" + '<span class="he right">' + formatHwbi(county.he) + '</span>');
												   tooltip.select(".lt").html('<text>Leisure Time:  </text>' + '<span class="lt_moe right">&plusmn;' + formatHwbi(county.lt_moe) + "</span>" + '<span class="lt right">' + formatHwbi(county.lt) + '</span>');
												   tooltip.select(".ls").html('<text>Living Standards:  </text>' + '<span class="ls_moe right">&plusmn;' + formatHwbi(county.ls_moe) + "</span>" + '<span class="ls right">' + formatHwbi(county.ls) + '</span>');
												   tooltip.select(".ss").html('<text>Safety &amp; Security:  </text>' + '<span class="ss_moe right">&plusmn;' + formatHwbi(county.ss_moe) + "</span>" + '<span class="ss right">' + formatHwbi(county.ss) + '</span>');
												   tooltip.select(".sc").html('<text>Social Cohesion:  </text>' + '<span class="sc_moe right">&plusmn;' + formatHwbi(county.sc_moe) + "</span>" + '<span class="sc right">' + formatHwbi(county.sc) + '</span>');

									// currFIPS = d.id;
									               // updateTooltip();

									               // timeout = setTimeout(updateClasses, 250);

									          })
									          .on("mouseout", function() {
									              d3.select(this).classed("selected", false);
									              // clearTimeout(timeout);
									                tooltip.transition().duration(300)
									                  .style("opacity", 0);
									          });

									    g.append("path")
									        .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
									        .attr("class", "states")
									        .attr("d", path);


									    // Zoom buttons
									    svg.selectAll(".button")
									        .data(['zoom_in', 'zoom_out'])
									      .enter()
									        .append("g")
									          .attr("id", function(d){return d})
									          .attr("class", "button")
									          .attr({x: 50, width: 50, height: 50})
									        .append("rect")
									            .attr("y", function(d,i) { return 50 + 55*i })
									            .attr({x: 50, width: 50, height: 50})
									    // Plus button
									    svg.select("#zoom_in")
									      .append("line")
									        .attr({x1: 60, y1: 75, x2: 90, y2: 75 })
									        .attr("stroke", "#fff")
									        .attr("stroke-width", "6px");
									    svg.select("#zoom_in")
									      .append("line")
									        .attr({x1: 75, y1: 60, x2: 75, y2: 90 })
									        .attr("stroke", "#fff")
									        .attr("stroke-width", "6px");
									    // Minus button
									    svg.select("#zoom_out")
									      .append("line")
									        .attr({x1: 60, y1: 130, x2: 90, y2: 130 })
									        .attr("stroke", "#fff")
									        .attr("stroke-width", "6px");


									    svg.selectAll(".button")
									      .on("click", function() {
									          d3.event.preventDefault();

									          var scale = zoom.scale(),
									              extent = zoom.scaleExtent(),
									              translate = zoom.translate(),
									              x = translate[0], y = translate[1],
									              factor = (this.id === 'zoom_in') ? 2 : 1/2,
									              target_scale = scale * factor;

									          var clamped_target_scale = Math.max(extent[0], Math.min(extent[1], target_scale));
									            if (clamped_target_scale != target_scale){
									                target_scale = clamped_target_scale;
									                factor = target_scale / scale;
									            }

									            // Center each vector, stretch, then put back
									            x = (x - center[0]) * factor + center[0];
									            y = (y - center[1]) * factor + center[1];

									            // Transition to the new view over 350ms
									            d3.transition().duration(350).tween("zoom", function () {
									                var interpolate_scale = d3.interpolate(scale, target_scale),
									                    interpolate_trans = d3.interpolate(translate, [x,y]);
									                return function (t) {
									                    zoom.scale(interpolate_scale(t))
									                        .translate(interpolate_trans(t));
									                    svg.call(zoom.event);
									                };
									            });
									      });




									      svg.select("#progress-image").remove();

									} // @end ready()


									function typeAndSet(d) {

									    d["hwbi"] = +d["hwbi"];
									    d["moe"] = +d["moe"];

									    hwbiByFIPS.set(d.FIPS, d);
									}


									function updateClasses() {
									    var currCounty = hwbiByFIPS.get(currFIPS);
									    currCountyMin = currCounty.hwbi - currCounty.moe;
									    currCountyMax = currCounty.hwbi + currCounty.moe;
									    svg.selectAll(".counties path")
									        .transition()
									        .duration(300)
									        .attr("fill", function(d) {
									            return classByHwbi(d.id);
									        });
									}




									function classByHwbi(FIPS) {
									    if (currFIPS == FIPS) {
									        return "#000000";
									    }

									    var currCounty = hwbiByFIPS.get(currFIPS);  // Currently selected county

									    var county = hwbiByFIPS.get(FIPS);

									    if (typeof county !== "undefined") {
									        var countyMin = county.hwbi - county.moe;
									        var countyMax = county.hwbi + county.moe;

									        if (currCounty.hwbi <= countyMax && countyMin <= currCounty.hwbi) {
									            return qcolors[2];
									        }
									        else if (county.hwbi < currCounty.hwbi) {
									            var diffRate = currCounty.hwbi - county.hwbi;
									            if (diffRate > currCounty.moe*2) {
									                return qcolors[4];
									            } else {
									                return qcolors[3];
									            }
									        } else {
									            var diffRate = county.hwbi - currCounty.hwbi;
									            if (diffRate > currCounty.moe*2) {
									                return qcolors[0];
									            } else {
									                return qcolors[1];
									            }

									        }

									    }

									    else {
									        return "#ffffff";
									    }
									}

									/*
									 * Generic Map Functions
									 */

									function zoomIn() {
									    zoom.scale(zoom.scale()*2);
									    move();
									}

									function move() {
									  var t = d3.event.translate,
									      s = d3.event.scale;
									  t[0] = Math.min(width * (s - 1), Math.max(width * (1 - s), t[0]));
									  t[1] = Math.min(height * (s - 1), Math.max(height * (1 - s), t[1]));
									  zoom.translate(t);
									  g.style("stroke-width", 1 / s).attr("transform", "translate(" + t + ")scale(" + s + ")");
									}

									function clicked(d) {
									  var x, y, k;

									  if (d && centered !== d) {
									    var centroid = path.centroid(d);
									    x = centroid[0];
									    y = centroid[1];
									    k = 4;
									    centered = d;
									  } else {
									    x = width / 2;
									    y = height / 2;
									    k = 1;
									    centered = null;
									  }

									  g.selectAll("path")
									      .classed("active", centered && function(d) { return d === centered; });

									  g.transition()
									      .duration(750)
									      .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")scale(" + k + ")translate(" + -x + "," + -y + ")")
									      .style("stroke-width", 1.5 / k + "px");
									}

								</script>

							</object>
						</div><br>
					</div>
				</div>
			</div>
		</section>



		<!-- Summary Section -->
		<section class="secFP" id="dataDescription">
			<div class="container-fluid text-center">
				<div class="row">
					<div class="col-md-10 col-md-offset-1 col-lg-8 col-lg-offset-2" >
						<p class="p2 subtext paddingfromtop wow fadeIn" data-wow-duration="2s" data-wow-delay=".15s">HWBI Data</p>
						<p class="wow fadeIn" data-wow-duration="2s" data-wow-delay=".45s">Input data consist of both subjective and objective information and include sources such as the U.S. Census Bureau American Community Survey, the Centers for Disease Control and Prevention Behavioral Risk Factor Surveillance System, and others. These data are evaluated using multiple linear regression and relationship-function statistical techniques to identify correlations and calculate coefficient values for each service. The HWBI model uses the resultant coefficients to process 22 economic, ecosystem, and social services values to calculate a total HWBI score as well as eight values for the “domains of well-being”: Connection to Nature, Cultural Fulfillment, Education, Health, Leisure Time, Living Standards, Safety and Security, and Social Cohesion.</p>
					</div>
				</div>
			</div>
		</section>



		<!-- Dashboard -->
		<section class="secFP" id="dashboard">
			<div class="container-fluid">

		        <!--title header -->
				<div class="row paddingfromtop">
					<div class="col-md-12 col-lg-10 col-lg-offset-1 wow fadeIn" data-wow-duration="2s" data-wow-delay=".2s">
						<h3>Explore HWBI services and domains</h3>
					</div>
				</div>

			   	<div class="row">

			        <!--left dashboard tools -->
					<div class="col-md-6 col-lg-5 col-lg-offset-1 wow fadeIn" data-wow-duration="2s" data-wow-delay=".2s">
				        <!--select state & county-->
     					<p>Select a state and county to view concentration and emission trends</p>
				        <div id="statecounty">
				          <form id="stateform">

					              <select name="optone" id="stateSel" class="form-control form-control-caret">
					                  <option value="" selected="selected">select state</option>
					              </select>
					              <br>
					              <select name="opttwo" id="countySel" size="1" class="form-control form-control-caret">
					                  <option value="" selected="selected">select county</option>
					              </select>
				              <br>
				          </form>
				        </div>

				        <script src="/static_qed/hwbi/js/statecounty.js"></script>


						<div>
							<!--white line divider -->
							<div><span></span></div>

							<!--toggle baseline and modified pies -->
							<div id="pie" class="tab-content current" style = "float:right; width: 50%;"></div>
							<div id="pie2" class="tab-content" style = "float:right; width: 50%;"></div>

							<label><input id="radios-id" type="radio" name="toggler" value="" checked />Modified Values</label>
							<label><input id="radios-id-2" type="radio" name="toggler" value="2" />Baseline County Values</label>

							<script src="/static_qed/hwbi/js/pie.js" ></script>
							<script src="/static_qed/hwbi/js/pie2.js" ></script>

							<!-- riv boxes-->
							<div id="riv" class="panel panel-default col-lg-6 col-md-6 col-sm-4 col-xs-5" style = "float:center; width: 50%;">

                                <style>
                                input[type=number] {
                                    width: 30px;
                                }

                                /* size button font */
                                #updateWeights {
                                    font-size: 12px;
                                }
                                </style>

                                 <p>
                                    <label style="display: inline-block; width: 200px; text-align: right">
                                           Connection to Nature= <span></span>
                                    </label>
                                    <input type="number" id="connectionToNatureDomainWeight" min="1" max="5" step="1" value="3">
                                  </p>

                                  <p>
                                    <label style="display: inline-block; width: 200px; text-align: right">
                                           Cultural Fulfillment= <span></span>
                                    </label>
                                    <input type="number" id="culturalFulfillmentDomainWeight" min="1" max="5" step="1" value="3">
                                  </p>

                                  <p>
                                    <label style="display: inline-block; width: 200px; text-align: right">
                                           Education= <span></span>
                                    </label>
                                    <input type="number" id="educationDomainWeight" min="1" max="5" step="1" value="3">
                                  </p>

                                  <p>
                                    <label style="display: inline-block; width: 200px; text-align: right">
                                           Health= <span></span>
                                    </label>
                                    <input type="number" id="healthDomainWeight" min="1" max="5" step="1" value="3">
                                  </p>

                                  <p>
                                    <label style="display: inline-block; width: 200px; text-align: right">
                                           Leisure Time= <span></span>
                                    </label>
                                    <input type="number" id="leisureTimeDomainWeight" min="1" max="5" step="1" value="3">
                                  </p>

                                  <p>
                                    <label style="display: inline-block; width: 200px; text-align: right">
                                           Living Standards= <span></span>
                                    </label>
                                    <input type="number" id="livingStandardsDomainWeight" min="1" max="5" step="1" value="3">
                                  </p>

                                  <p>
                                    <label style="display: inline-block; width: 200px; text-align: right">
                                           Safety & Security= <span></span>
                                    </label>
                                    <input type="number" id="safetyAndSecurityDomainWeight" min="1" max="5" step="1" value="3">
                                  </p>

                                  <p>
                                    <label style="display: inline-block; width: 200px; text-align: right">
                                           Social Cohesion= <span></span>
                                    </label>
                                    <input type="number" id="socialCohesionDomainWeight" min="1" max="5" step="1" value="3">
                                  </p>

                                <!--button to submit RIV box weights to pie chart-->
                                <button id="updateWeights" onclick="useRIVWeights()" type="submit" class="btn btn-primary btn-xs" role="button">Modify RIV Weights</button>

                            </div>

                            <div class="radio-toolbar">
                            <label><input id="radios-id" type="radio" name="toggler" value="" checked />Modified Values</label>
                            <label><input id="radios-id-2" type="radio" name="toggler" value="2" />Baseline County Values</label>

                                    <div id="pie" class="tab-content current" style = "float:right; width: 50%;"></div>
                                    <div id="pie2" class="tab-content" style = "float:right; width: 50%;"></div>
                            </div>



							<script>
							$(function() {
							    $("[name=toggler]").click(function(){
							            $('.tab-content').hide();
							            $("#pie"+$(this).val()).show();
							    });
							 });
							</script>

							<script>
							$(document).ready(function(){

							$('ul.tabs li').click(function(){
							    var tab_id = $(this).attr('data-tab');

							    $('ul.tabs li').removeClass('current');
							    $('.tab-content').removeClass('current');

							    $(this).addClass('current');
							    $("#"+tab_id).addClass('current');
							})
							})
							</script>

						</div>

					  <p class="em_95"><span class="label label-custom">Importance</span>Rank the importance of domains based on <i>your</i> preferences. A value of 5 is considered most important and a value of 1 has lowest importance. The relative importance values are represented by the width of pieces on the pie chart and are used to calculate the overall HWBI score.</p>
					</div>


					<div class="col-md-6 col-lg-5 wow fadeIn" data-wow-duration="2s" data-wow-delay=".2s">
                        <!--Text description of HWBI pie-->
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="float:left; width: 100%; text-align:left">
                            <p>
                            The relative importance of domains may vary for each person. Use the boxes to rank
                            the importance of domains based on <i>your</i> preferences. A value of 5
                            is considered most important and a value of 1 has lowest importance.
                        <br>
                        <br>
                            Adjust the services sliders to examine how changing services affects domain values and the overall HWBI.
                            </p>

                            <!--Sliders to adjust circle services-->
                            <div id="cirSlide" style = "margin-left: 5px;"></div>
                            <script src="/static_qed/hwbi/js/slider.js"></script>

                            <!--button to submit updated services to pie chart-->
                            <button id="updateServices" onclick="useServiceValues()" type="submit" class="btn btn-primary btn-xs" role="button">Modify Service Values</button>

                        </div>
					</div>
				</div>
			</div>
		</section>







		<!-- algorithms Section -->
		<section class="secFP" id="algorithms">
			<div class="container-fluid">
				<div class="row paddingfromtop">
					<div class="col-md-4 col-lg-4 col-lg-offset-1 wow fadeIn" data-wow-duration="2s" data-wow-delay=".2s">

					</div>
					<div class="col-md-8 col-lg-6 wow fadeInRight" data-wow-duration="2s" data-wow-delay=".4s">

					</div>
				</div>
			</div>
		</section>

		<!-- Overview Section -->
		<section class="secFP">
			<div class="container">
				<div class="row">
					<div class="col-md-10 col-md-offset-1 wow fadeIn" data-wow-duration="2s" data-wow-delay=".2s">
						<h2 class="story-text">Economic, ecosystem, and social services directly relate to human well-being.</h2>
					</div>
				</div>
			</div>
		</section>

		<!-- Resources Section -->
		<section class="secFP" id="resources">
			<div class="container-fluid resource-section text-center">
					<div class="col-md-10 col-md-offset-1 col-lg-8 col-lg-offset-2 wow fadeIn" data-wow-duration="2s" data-wow-delay=".2s">
						<p class="subtext p2">Additional Resources</p>
						<p>Please visit other Q.E.D. websites.</p>
						<ul class="list-inline banner-social-buttons">
							<li><a href="https://qed.epa.gov/pram" class="btn hvr-sweep-to-right btn-lg" target="_blank" title="Click to view übertool website">übertool</a></li>
							<li><a href="https://qed.epa.gov/cts" class="btn hvr-sweep-to-right btn-lg" target="_blank" title="Click to view CTS website">CTS</a></li>
							<li><a href="https://qed.epa.gov/hem" class="btn hvr-sweep-to-right btn-lg" target="_blank" title="Click to view HEM website">HEM</a></li>
							<li><a href="https://qed.epa.gov/hms" class="btn hvr-sweep-to-right btn-lg" target="_blank" title="Click to view HMS website">HMS</a></li>
							<li><a href="https://qed.epa.gov/pisces" class="btn hvr-sweep-to-right btn-lg" target="_blank" title="Click to view Pisces website">pisces</a></li>
						</ul>
					</div>
			</div>
		</section>


		<!-- Social Media Section -->
		<section class="secFP" id="epaSocial">
			<div class="container-fluid social-section">
				<div class="row">
					<div class="col-md-10 col-md-offset-1 col-lg-8 col-lg-offset-2 wow fadeIn" data-wow-duration="2s" data-wow-delay=".2s">
						<ul class="list-inline banner-social-buttons">
							<li><a href="https://twitter.com/EPA" class="btn hvr-sweep-to-right btn-lg" target="_blank" title="EPA on Twitter"><i class="icon icon-twitter fa-fw" aria-hidden="true"></i> <span class="network-name">Twitter</span></a></li>
							<li><a href="https://www.facebook.com/EPA" class="btn hvr-sweep-to-right btn-lg" target="_blank" title="EPA on Facebook"><i class="icon icon-facebook fa-fw" aria-hidden="true"></i> <span class="network-name">Facebook</span></a></li>
							<li><a href="https://www.youtube.com/user/USEPAgov/featured" class="btn hvr-sweep-to-right btn-lg" target="_blank" title="EPA on YouTube"><i class="icon icon-youtube fa-fw" aria-hidden="true"></i> <span class="network-name">YouTube</span></a></li>
						</ul>
					</div>
				</div>
			</div>

			<!-- Footer -->
{#			<footer>#}
{#				<div class="container-fluid text-center wow fadeIn" data-wow-duration="2s" data-wow-delay=".2s">#}
{#					<img src="/static_qed/hwbi/images/epa_seal_medium_trim_80x80.png" alt="United States Environmental Protection Agency">#}
{#				</div>#}
{#			</footer>#}
		</section>
	</div>


    <!-- jQuery ajax expension (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
	<!-- Bootstrap -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

	<!--custom code -->
	<script type="text/javascript" src="/static_qed/hwbi/js/etrends.js"> </script>
	<!-- Wow -->
{#     <script type="text/javascript">#}
{#		var wow = new WOW(#}
{#			{#}
{#				boxClass: 'wow',#}
{#				animateClass: 'animated',#}
{#				offset: -300,#}
{#				mobile: false,#}
{#				live: true,#}
{#			}#}
{#		);#}
{#		wow.init();#}
    </script>

	<script>
{#	var min_w = 300; // minimum video width allowed#}
{#	var vid_w_orig;  // original video dimensions#}
{#	var vid_h_orig;#}
{#	jQuery(function() { // runs after DOM has loaded#}
{##}
{#		vid_w_orig = parseInt(jQuery('#nasa-video').attr('width'));#}
{#		vid_h_orig = parseInt(jQuery('#nasa-video').attr('height'));#}
{##}
{#		jQuery(window).resize(function () { resizeToCover(); });#}
{#		jQuery(window).trigger('resize');#}
{#	});#}
{#	function resizeToCover() {#}
{#		// set the video viewport to the window size#}
{#		jQuery('#video-container').width(jQuery(window).width());#}
{#		jQuery('#video-container').height(jQuery(window).height());#}
{#		// use largest scale factor of horizontal/vertical#}
{#		var scale_h = jQuery(window).width() / vid_w_orig;#}
{#		var scale_v = jQuery(window).height() / vid_h_orig;#}
{#		var scale = scale_h > scale_v ? scale_h : scale_v;#}
{#		// don't allow scaled width < minimum video width#}
{#		if (scale * vid_w_orig < min_w) {scale = min_w / vid_w_orig;};#}
{#		// now scale the video#}
{#		jQuery('#nasa-video').width(scale * vid_w_orig);#}
{#		jQuery('#nasa-video').height(scale * vid_h_orig);#}
{#		// and center it by scrolling the video viewport#}
{#		jQuery('#video-container').scrollLeft((jQuery('#nasa-video').width() - jQuery(window).width()) / 2);#}
{#		jQuery('#video-container').scrollTop((jQuery('#nasa-video').height() - jQuery(window).height()) / 2);#}
{#	};#}
	</script>

 </body>
 </html>