<div id="microspecies-distribution" class="plot" tabindex="0" aria-label="microspecies distribution"></div>

<script type="text/javascript">
function plotMicroDist() {

  var dataArr = JSON.parse($('#microDistData1').text());

  var colorSet1 = ['#1a1423', '#1e7272', '#b55f3a', '#454545', '#372549'];
  var colorSet2 = ['#7bb399', '#1e7272', '#ba613b', '#454545', '#202020'];

  // NOTE: Using color set 2
  var seriesInfo = [
    {
      label: 'microspecies1',
      color: '#7bb399'
    },
    {
      label: 'microspecies2',
      color: '#1e7272'
    },
    {
      label: 'microspecies3',
      color: '#515151'  // originally #454545
    },
    {
      label: 'microspecies4',
      color: '#ba613b',
    },
    {
      label: 'microspecies5',
      color: '#202020'
    },
    {
      label: 'microspecies6',
      color: '#7bb399',
      linePattern: 'dotted'
    },
    {
      label: 'microspecies7',
      color: '#1e7272',
      linePattern: 'dotted'
    },
    {
      label: 'microspecies8',
      color: '#ba613b',
      linePattern: 'dotted'
    },
    {
      label: 'microspecies9',
      color: '#515151',
      linePattern: 'dotted'
    },
    {
      label: 'microspecies10',
      color: '#202020',
      linePattern: 'dotted'
    },
    {
      label: 'microspecies11',
      color: '#7bb399',
      linePattern: 'dashed'
    },
    {
      label: 'microspecies12',
      color: '#1e7272',
      linePattern: 'dashed'
    },
    {
      label: 'microspecies13',
      color: '#ba613b',
      linePattern: 'dashed'
    },
    {
      label: 'microspecies14',
      color: '#515151',
      linePattern: 'dashed'
    },
    {
      label: 'microspecies15',
      color: '#202020',
      linePattern: 'dashed'
    }
  ];
  var plotData = [];

  //get keys for series labels, then convert back to list for plotting
  for (var key in dataArr) {
    if (dataArr.hasOwnProperty(key)) {
      //do stuff with dict items not in prototype object
      var seriesObj = {
        label:key
      };
      seriesInfo.push(seriesObj);
      plotData.push(dataArr[key]);
    }
  }


  // getting parent div dimensions:
  var parent_div_height = $('#microspecies-distribution').height();
  var parent_div_width = $('#microspecies-distribution').width();


  var plot = $.jqplot ('microspecies-distribution', plotData, {

    height: parent_div_height,
    width: parent_div_width,

    title: {
      text: 'Microspecies Distribution (%)',
      fontSize: '10pt'
    },
    series: seriesInfo,
    axes: {
      xaxis: {
        label: 'pH',
        min: 0,
        max: 14,
        tickInterval: 1,
        labelOptions: {
          fontSize: '8pt'
        }
      },
      yaxis: {
        min: 0,
        max: 100,
        tickInterval: 10
      }
    },
    seriesDefaults: {
      showMarker: false
    },
    highlighter: {
      show: true,
      sizeAdjust: 7.5
    },
    grid: {
      background: '#ffffff'
    }
  });

  // Get series colors to make microspecies image border
  // the same as its series color
  var ms_num = 1;
  $('td#ms-cell div.chemspec_molecule').find('svg').each(function () {
      // add metabolites class:
      // $(this).addClass("metabolite");  // doesn't work with svg
      $(this).attr('class', "metabolite");
      $(this).attr('id', "microspecies" + ms_num);
      ms_num += 1;
  });

  // Gets microspecies' color and name to add to borders of
  // microspecies images:
  for (var series in plot['series']) {
    var color = plot['series'][series]['color']; // series color..
    var name = plot['series'][series]['label']; // series name..
    var linePattern = plot['series'][series]['linePattern'];
    // $('#' + name).parent('div').css('border', '5px solid ' + color); // sets border color
    // $('#' + name).css({'border': 'none', 'margin': '0px'}); // remove image border..
    if (linePattern == 'dotted') {
      $('#' + name).parent('div').css({'border': '5px solid ' + color, 'border-style': 'dotted'}); // sets border 
    }
    else if (linePattern == 'dashed') {
      $('#' + name).parent('div').css({'border': '5px solid ' + color, 'border-style': 'dashed'}); // sets border
    }
    else {
      $('#' + name).parent('div').css('border', '5px solid ' + color); // sets border 
    }
    $('#' + name).css({'border': 'none', 'margin': '0px'}); // remove image border..
  }

  // 508 compliance fixes:
  // ++++++++++++++++++++++++++++++++++++++++++++++++++++
  let microspeciesCount = 0;
  var plotCanvas = $('canvas').each(function() {
    let plotType = $(this).parent('div').attr('id');
    if (plotType == 'microspecies-distribution') {
      if ($(this).hasClass('jqplot-series-canvas')) {
        microspeciesCount += 1;
        $(this).attr({'aria-label': "microspecies" + microspeciesCount});  
      }
      else {
        $(this).attr({'aria-label': "microspecies distribution vs pH plot"});
      }
    }
  });
  // ++++++++++++++++++++++++++++++++++++++++++++++++++++

}
</script>

<script type="text/javascript">
$(document).ready(function () {
  plotMicroDist();
  $('jqplot-series-canvas').hover(function() {
    // Loops each microspecies plot div (in order, hopefully).
    // Creating interactivity with plot line and microspecies image.
    var microspeciesNumber = $(this).attr('aria-label');
    var matchingMicrospecis = $('div.cts-chem-wrap')
  });
});
// plotMicroDist();
</script>